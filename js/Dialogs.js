/**
 * Copyright (c) 2006-2012, JGraph Ltd
 */
var OpenDialog=function(){var e=document.createElement("iframe");e.style.backgroundColor="transparent",e.allowTransparency="true",e.style.borderStyle="none",e.style.borderWidth="0px",e.style.overflow="hidden",e.frameBorder="0";var t=mxClient.IS_VML&&(null==document.documentMode||document.documentMode<8)?20:0;e.setAttribute("width",(Editor.useLocalStorage?640:320)+t+"px"),e.setAttribute("height",(Editor.useLocalStorage?480:220)+t+"px"),e.setAttribute("src",OPEN_FORM),this.container=e},ColorDialog=function(e,t,l,i){this.editorUi=e;var a=document.createElement("input");a.style.marginBottom="10px",a.style.width="216px",mxClient.IS_IE&&(a.style.marginTop="10px",document.body.appendChild(a));var n=null!=l?l:this.createApplyFunction();function r(){var t=a.value;/(^#?[a-zA-Z0-9]*$)/.test(t)?("none"!=t&&"#"!=t.charAt(0)&&(t="#"+t),ColorDialog.addRecentColor("none"!=t?t.substring(1):t,12),n(t),e.hideDialog()):e.handleError({message:mxResources.get("invalidInput")})}this.init=function(){mxClient.IS_TOUCH||a.focus()};var o=new mxJSColor.color(a);o.pickerOnfocus=!1,o.showPicker();var d=document.createElement("div");mxJSColor.picker.box.style.position="relative",mxJSColor.picker.box.style.width="230px",mxJSColor.picker.box.style.height="100px",mxJSColor.picker.box.style.paddingBottom="10px",d.appendChild(mxJSColor.picker.box);var s=document.createElement("center");function p(){var e=c(0==ColorDialog.recentColors.length?["FFFFFF"]:ColorDialog.recentColors,11,"FFFFFF",!0);return e.style.marginBottom="8px",e}function c(e,t,l,i){t=null!=t?t:12;var n=document.createElement("table");n.style.borderCollapse="collapse",n.setAttribute("cellspacing","0"),n.style.marginBottom="20px",n.style.cellSpacing="0px";var d=document.createElement("tbody");n.appendChild(d);for(var c=e.length/t,u=0;u<c;u++){for(var g=document.createElement("tr"),h=0;h<t;h++)!function(e){var t=document.createElement("td");t.style.border="1px solid black",t.style.padding="0px",t.style.width="16px",t.style.height="16px",null==e&&(e=l),"none"==e?t.style.background="url('"+Dialog.prototype.noColorImage+"')":t.style.backgroundColor="#"+e,g.appendChild(t),null!=e&&(t.style.cursor="pointer",mxEvent.addListener(t,"click",function(){"none"==e?(o.fromString("ffffff"),a.value="none"):o.fromString(e)}),mxEvent.addListener(t,"dblclick",r))}(e[u*t+h]);d.appendChild(g)}if(i){var m=document.createElement("td");m.setAttribute("title",mxResources.get("reset")),m.style.border="1px solid black",m.style.padding="0px",m.style.width="16px",m.style.height="16px",m.style.backgroundImage="url('"+Dialog.prototype.closeImage+"')",m.style.backgroundPosition="center center",m.style.backgroundRepeat="no-repeat",m.style.cursor="pointer",g.appendChild(m),mxEvent.addListener(m,"click",function(){ColorDialog.resetRecentColors(),n.parentNode.replaceChild(p(),n)})}return s.appendChild(n),n}d.appendChild(a),mxUtils.br(d),p();var u=c(this.presetColors);u.style.marginBottom="8px",(u=c(this.defaultColors)).style.marginBottom="16px",d.appendChild(s);var g=document.createElement("div");g.style.textAlign="right",g.style.whiteSpace="nowrap";var h=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog(),null!=i&&i()});h.className="geBtn",e.editor.cancelFirst&&g.appendChild(h);var m=mxUtils.button(mxResources.get("apply"),r);m.className="geBtn gePrimaryBtn",g.appendChild(m),e.editor.cancelFirst||g.appendChild(h),null!=t&&("none"==t?(o.fromString("ffffff"),a.value="none"):o.fromString(t)),d.appendChild(g),this.picker=o,this.colorInput=a,mxEvent.addListener(d,"keydown",function(t){27==t.keyCode&&(e.hideDialog(),null!=i&&i(),mxEvent.consume(t))}),this.container=d};ColorDialog.prototype.presetColors=["E6D0DE","CDA2BE","B5739D","E1D5E7","C3ABD0","A680B8","D4E1F5","A9C4EB","7EA6E0","D5E8D4","9AC7BF","67AB9F","D5E8D4","B9E0A5","97D077","FFF2CC","FFE599","FFD966","FFF4C3","FFCE9F","FFB570","F8CECC","F19C99","EA6B66"],ColorDialog.prototype.defaultColors=["none","FFFFFF","E6E6E6","CCCCCC","B3B3B3","999999","808080","666666","4D4D4D","333333","1A1A1A","000000","FFCCCC","FFE6CC","FFFFCC","E6FFCC","CCFFCC","CCFFE6","CCFFFF","CCE5FF","CCCCFF","E5CCFF","FFCCFF","FFCCE6","FF9999","FFCC99","FFFF99","CCFF99","99FF99","99FFCC","99FFFF","99CCFF","9999FF","CC99FF","FF99FF","FF99CC","FF6666","FFB366","FFFF66","B3FF66","66FF66","66FFB3","66FFFF","66B2FF","6666FF","B266FF","FF66FF","FF66B3","FF3333","FF9933","FFFF33","99FF33","33FF33","33FF99","33FFFF","3399FF","3333FF","9933FF","FF33FF","FF3399","FF0000","FF8000","FFFF00","80FF00","00FF00","00FF80","00FFFF","007FFF","0000FF","7F00FF","FF00FF","FF0080","CC0000","CC6600","CCCC00","66CC00","00CC00","00CC66","00CCCC","0066CC","0000CC","6600CC","CC00CC","CC0066","990000","994C00","999900","4D9900","009900","00994D","009999","004C99","000099","4C0099","990099","99004D","660000","663300","666600","336600","006600","006633","006666","003366","000066","330066","660066","660033","330000","331A00","333300","1A3300","003300","00331A","003333","001933","000033","190033","330033","33001A"],ColorDialog.prototype.createApplyFunction=function(){return mxUtils.bind(this,function(e){var t=this.editorUi.editor.graph;t.getModel().beginUpdate();try{t.setCellStyles(this.currentColorKey,e),this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[this.currentColorKey],"values",[e],"cells",t.getSelectionCells()))}finally{t.getModel().endUpdate()}})},ColorDialog.recentColors=[],ColorDialog.addRecentColor=function(e,t){null!=e&&(mxUtils.remove(e,ColorDialog.recentColors),ColorDialog.recentColors.splice(0,0,e),ColorDialog.recentColors.length>=t&&ColorDialog.recentColors.pop())},ColorDialog.resetRecentColors=function(){ColorDialog.recentColors=[]};var AboutDialog=function(e){var t=document.createElement("div");t.setAttribute("align","center");var l=document.createElement("h3");mxUtils.write(l,mxResources.get("about")+" GraphEditor"),t.appendChild(l);var i=document.createElement("img");i.style.border="0px",i.setAttribute("width","176"),i.setAttribute("width","151"),i.setAttribute("src",IMAGE_PATH+"/logo.png"),t.appendChild(i),mxUtils.br(t),mxUtils.write(t,"Powered by mxGraph "+mxClient.VERSION),mxUtils.br(t);var a=document.createElement("a");a.setAttribute("href","http://www.jgraph.com/"),a.setAttribute("target","_blank"),mxUtils.write(a,"www.jgraph.com"),t.appendChild(a),mxUtils.br(t),mxUtils.br(t);var n=mxUtils.button(mxResources.get("close"),function(){e.hideDialog()});n.className="geBtn gePrimaryBtn",t.appendChild(n),this.container=t},ImageDialog=function(e,t,l){var i=document.createElement("div");i.setAttribute("align","center");var a=document.createElement("h3");mxUtils.write(a,"Insert Image"),i.appendChild(a);var n=document.createElement("input");n.type="file",n.accept="image/*",n.style.marginTop="8px",n.style.marginBottom="16px",i.appendChild(n);var r=document.createElement("div");r.setAttribute("align","right");var o=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog(),null!=l&&l()});o.className="geBtn",r.appendChild(o);var d=mxUtils.button("Insert",function(){var l=new Image;l.onload=()=>{t(l.src,l.width,l.height)},l.src=URL.createObjectURL(n.files[0]),console.log(l),e.hideDialog()});d.className="geBtn gePrimaryBtn",r.appendChild(d),i.append(r),this.container=i},TextareaDialog=function(e,t,l,i,a,n,r,o,d,s,p,c,u,g){r=null!=r?r:300,o=null!=o?o:120,s=null!=s&&s;var h,m,$=document.createElement("table"),b=document.createElement("tbody");h=document.createElement("tr"),(m=document.createElement("td")).style.fontSize="10pt",m.style.width="100px",mxUtils.write(m,t),h.appendChild(m),b.appendChild(h),h=document.createElement("tr"),m=document.createElement("td");var v=document.createElement("textarea");if(p&&v.setAttribute("wrap","off"),v.setAttribute("spellcheck","false"),v.setAttribute("autocorrect","off"),v.setAttribute("autocomplete","off"),v.setAttribute("autocapitalize","off"),mxUtils.write(v,l||""),v.style.resize="none",v.style.width=r+"px",v.style.height=o+"px",this.textarea=v,this.init=function(){v.focus(),v.scrollTop=0},m.appendChild(v),h.appendChild(m),b.appendChild(h),h=document.createElement("tr"),(m=document.createElement("td")).style.paddingTop="14px",m.style.whiteSpace="nowrap",m.setAttribute("align","right"),null!=u){var C=mxUtils.button(mxResources.get("help"),function(){e.editor.graph.openLink(u)});C.className="geBtn",m.appendChild(C)}if(null!=g)for(var y=0;y<g.length;y++)!function(e,t){var l=mxUtils.button(e,function(e){t(e,v)});l.className="geBtn",m.appendChild(l)}(g[y][0],g[y][1]);var f=mxUtils.button(n||mxResources.get("cancel"),function(){e.hideDialog(),null!=a&&a()});if(f.className="geBtn",e.editor.cancelFirst&&m.appendChild(f),null!=d&&d(m,v),null!=i){var w=mxUtils.button(c||mxResources.get("apply"),function(){s||e.hideDialog(),i(v.value)});w.className="geBtn gePrimaryBtn",m.appendChild(w)}e.editor.cancelFirst||m.appendChild(f),h.appendChild(m),b.appendChild(h),$.appendChild(b),this.container=$},EditDiagramDialog=function(e){var t=document.createElement("div");t.style.textAlign="right";var l=document.createElement("textarea");l.setAttribute("wrap","off"),l.setAttribute("spellcheck","false"),l.setAttribute("autocorrect","off"),l.setAttribute("autocomplete","off"),l.setAttribute("autocapitalize","off"),l.style.overflow="auto",l.style.resize="none",l.style.width="600px",l.style.height="360px",l.style.marginBottom="16px",l.value=mxUtils.getPrettyXml(e.editor.getGraphXml()),t.appendChild(l),this.init=function(){l.focus()},Graph.fileSupport&&(l.addEventListener("dragover",function e(t){t.stopPropagation(),t.preventDefault()},!1),l.addEventListener("drop",function t(i){if(i.stopPropagation(),i.preventDefault(),i.dataTransfer.files.length>0){var a=i.dataTransfer.files[0],n=new FileReader;n.onload=function(e){l.value=e.target.result},n.readAsText(a)}else l.value=e.extractGraphModelFromEvent(i)},!1));var i=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog()});i.className="geBtn",e.editor.cancelFirst&&t.appendChild(i);var a=document.createElement("select");if(a.style.width="180px",a.className="geBtn",e.editor.graph.isEnabled()){var n=document.createElement("option");n.setAttribute("value","replace"),mxUtils.write(n,mxResources.get("replaceExistingDrawing")),a.appendChild(n)}var r=document.createElement("option");if(r.setAttribute("value","new"),mxUtils.write(r,mxResources.get("openInNewWindow")),EditDiagramDialog.showNewWindowOption&&a.appendChild(r),e.editor.graph.isEnabled()){var o=document.createElement("option");o.setAttribute("value","import"),mxUtils.write(o,mxResources.get("addToExistingDrawing")),a.appendChild(o)}t.appendChild(a);var d=mxUtils.button(mxResources.get("ok"),function(){var t=Graph.zapGremlins(mxUtils.trim(l.value)),i=null;if("new"==a.value)e.hideDialog(),e.editor.editAsNew(t);else if("replace"==a.value){e.editor.graph.model.beginUpdate();try{e.editor.setGraphXml(mxUtils.parseXml(t).documentElement),e.hideDialog()}catch(n){i=n}finally{e.editor.graph.model.endUpdate()}}else if("import"==a.value){e.editor.graph.model.beginUpdate();try{var r=mxUtils.parseXml(t),o=new mxGraphModel;new mxCodec(r).decode(r.documentElement,o);var d=o.getChildren(o.getChildAt(o.getRoot(),0));e.editor.graph.setSelectionCells(e.editor.graph.importCells(d)),e.hideDialog()}catch(s){i=s}finally{e.editor.graph.model.endUpdate()}}null!=i&&mxUtils.alert(i.message)});d.className="geBtn gePrimaryBtn",t.appendChild(d),e.editor.cancelFirst||t.appendChild(i),this.container=t};EditDiagramDialog.showNewWindowOption=!0;var ExportDialog=function(e){var t,l,i=e.editor.graph,a=i.getGraphBounds(),n=i.view.scale,r=Math.ceil(a.width/n),o=Math.ceil(a.height/n),d=document.createElement("table"),s=document.createElement("tbody");d.setAttribute("cellpadding",mxClient.IS_SF?"0":"2"),t=document.createElement("tr"),(l=document.createElement("td")).style.fontSize="10pt",l.style.width="100px",mxUtils.write(l,mxResources.get("filename")+":"),t.appendChild(l);var p=document.createElement("input");p.setAttribute("value",e.editor.getOrCreateFilename()),p.style.width="180px",(l=document.createElement("td")).appendChild(p),t.appendChild(l),s.appendChild(t),t=document.createElement("tr"),(l=document.createElement("td")).style.fontSize="10pt",mxUtils.write(l,mxResources.get("format")+":"),t.appendChild(l);var c=document.createElement("select");c.style.width="180px";var u=document.createElement("option");u.setAttribute("value","png"),mxUtils.write(u,mxResources.get("formatPng")),c.appendChild(u);var g=document.createElement("option");ExportDialog.showGifOption&&(g.setAttribute("value","gif"),mxUtils.write(g,mxResources.get("formatGif")),c.appendChild(g));var h=document.createElement("option");h.setAttribute("value","jpg"),mxUtils.write(h,mxResources.get("formatJpg")),c.appendChild(h);var m=document.createElement("option");m.setAttribute("value","pdf"),mxUtils.write(m,mxResources.get("formatPdf")),c.appendChild(m);var $=document.createElement("option");if($.setAttribute("value","svg"),mxUtils.write($,mxResources.get("formatSvg")),c.appendChild($),ExportDialog.showXmlOption){var b=document.createElement("option");b.setAttribute("value","xml"),mxUtils.write(b,mxResources.get("formatXml")),c.appendChild(b)}(l=document.createElement("td")).appendChild(c),t.appendChild(l),s.appendChild(t),t=document.createElement("tr"),(l=document.createElement("td")).style.fontSize="10pt",mxUtils.write(l,mxResources.get("zoom")+" (%):"),t.appendChild(l);var v=document.createElement("input");v.setAttribute("type","number"),v.setAttribute("value","100"),v.style.width="180px",(l=document.createElement("td")).appendChild(v),t.appendChild(l),s.appendChild(t),t=document.createElement("tr"),(l=document.createElement("td")).style.fontSize="10pt",mxUtils.write(l,mxResources.get("width")+":"),t.appendChild(l);var C=document.createElement("input");C.setAttribute("value",r),C.style.width="180px",(l=document.createElement("td")).appendChild(C),t.appendChild(l),s.appendChild(t),t=document.createElement("tr"),(l=document.createElement("td")).style.fontSize="10pt",mxUtils.write(l,mxResources.get("height")+":"),t.appendChild(l);var y=document.createElement("input");y.setAttribute("value",o),y.style.width="180px",(l=document.createElement("td")).appendChild(y),t.appendChild(l),s.appendChild(t),t=document.createElement("tr"),(l=document.createElement("td")).style.fontSize="10pt",mxUtils.write(l,mxResources.get("dpi")+":"),t.appendChild(l);var f=document.createElement("select");f.style.width="180px";var w=document.createElement("option");w.setAttribute("value","100"),mxUtils.write(w,"100dpi"),f.appendChild(w);var F=document.createElement("option");F.setAttribute("value","200"),mxUtils.write(F,"200dpi"),f.appendChild(F);var E=document.createElement("option");E.setAttribute("value","300"),mxUtils.write(E,"300dpi"),f.appendChild(E);var x=document.createElement("option");x.setAttribute("value","400"),mxUtils.write(x,"400dpi"),f.appendChild(x);var _=document.createElement("option");_.setAttribute("value","custom"),mxUtils.write(_,mxResources.get("custom")),f.appendChild(_);var A=document.createElement("input");A.style.width="180px",A.style.display="none",A.setAttribute("value","100"),A.setAttribute("type","number"),A.setAttribute("min","50"),A.setAttribute("step","50");var k=!1;mxEvent.addListener(f,"change",function(){"custom"==this.value?(this.style.display="none",A.style.display="",A.focus()):(A.value=this.value,k||(v.value=this.value))}),mxEvent.addListener(A,"change",function(){var e=parseInt(A.value);isNaN(e)||e<=0?A.style.backgroundColor="red":(A.style.backgroundColor="",k||(v.value=e))}),(l=document.createElement("td")).appendChild(f),l.appendChild(A),t.appendChild(l),s.appendChild(t),t=document.createElement("tr"),(l=document.createElement("td")).style.fontSize="10pt",mxUtils.write(l,mxResources.get("background")+":"),t.appendChild(l);var D=document.createElement("input");D.setAttribute("type","checkbox"),D.checked=null==i.background||i.background==mxConstants.NONE,(l=document.createElement("td")).appendChild(D),mxUtils.write(l,mxResources.get("transparent")),t.appendChild(l),s.appendChild(t),t=document.createElement("tr"),(l=document.createElement("td")).style.fontSize="10pt",mxUtils.write(l,mxResources.get("borderWidth")+":"),t.appendChild(l);var S=document.createElement("input");function L(){var e=p.value,t=e.lastIndexOf(".");t>0?p.value=e.substring(0,t+1)+c.value:p.value=e+"."+c.value,"xml"===c.value?(v.setAttribute("disabled","true"),C.setAttribute("disabled","true"),y.setAttribute("disabled","true"),S.setAttribute("disabled","true")):(v.removeAttribute("disabled"),C.removeAttribute("disabled"),y.removeAttribute("disabled"),S.removeAttribute("disabled")),"png"===c.value||"svg"===c.value||"pdf"===c.value?D.removeAttribute("disabled"):D.setAttribute("disabled","disabled"),"png"===c.value?(f.removeAttribute("disabled"),A.removeAttribute("disabled")):(f.setAttribute("disabled","disabled"),A.setAttribute("disabled","disabled"))}function B(){C.value*y.value>MAX_AREA||C.value<=0?C.style.backgroundColor="red":C.style.backgroundColor="",C.value*y.value>MAX_AREA||y.value<=0?y.style.backgroundColor="red":y.style.backgroundColor=""}S.setAttribute("type","number"),S.setAttribute("value",ExportDialog.lastBorderValue),S.style.width="180px",(l=document.createElement("td")).appendChild(S),t.appendChild(l),s.appendChild(t),d.appendChild(s),mxEvent.addListener(c,"change",L),L(),mxEvent.addListener(v,"change",function(){k=!0;var e=Math.max(0,parseFloat(v.value)||100)/100;v.value=parseFloat((100*e).toFixed(2)),r>0?(C.value=Math.floor(r*e),y.value=Math.floor(o*e)):(v.value="100",C.value=r,y.value=o),B()}),mxEvent.addListener(C,"change",function(){var e=parseInt(C.value)/r;e>0?(v.value=parseFloat((100*e).toFixed(2)),y.value=Math.floor(o*e)):(v.value="100",C.value=r,y.value=o),B()}),mxEvent.addListener(y,"change",function(){var e=parseInt(y.value)/o;e>0?(v.value=parseFloat((100*e).toFixed(2)),C.value=Math.floor(r*e)):(v.value="100",C.value=r,y.value=o),B()}),t=document.createElement("tr"),(l=document.createElement("td")).setAttribute("align","right"),l.style.paddingTop="22px",l.colSpan=2;var I=mxUtils.button(mxResources.get("export"),mxUtils.bind(this,function(){if(0>=parseInt(v.value))mxUtils.alert(mxResources.get("drawingEmpty"));else{var t=p.value,l=c.value,a=Math.max(0,parseFloat(v.value)||100)/100,n=Math.max(0,parseInt(S.value)),r=i.background,o=Math.max(1,parseInt(A.value));("svg"==l||"png"==l||"pdf"==l)&&D.checked?r=null:(null==r||r==mxConstants.NONE)&&(r="#ffffff"),ExportDialog.lastBorderValue=n,ExportDialog.exportFile(e,t,l,r,a,n,o)}}));I.className="geBtn gePrimaryBtn";var N=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog()});N.className="geBtn",e.editor.cancelFirst?(l.appendChild(N),l.appendChild(I)):(l.appendChild(I),l.appendChild(N)),t.appendChild(l),s.appendChild(t),d.appendChild(s),this.container=d};ExportDialog.lastBorderValue=0,ExportDialog.showGifOption=!0,ExportDialog.showXmlOption=!0,ExportDialog.exportFile=function(e,t,l,i,a,n,r){var o=e.editor.graph;if("xml"==l)ExportDialog.saveLocalFile(e,mxUtils.getXml(e.editor.getGraphXml()),t,l);else if("svg"==l)ExportDialog.saveLocalFile(e,mxUtils.getXml(o.getSvg(i,a,n)),t,l);else{var d=o.getGraphBounds(),s=mxUtils.createXmlDocument(),p=s.createElement("output");s.appendChild(p);var c=new mxXmlCanvas2D(p);c.translate(Math.floor((n/a-d.x)/o.view.scale),Math.floor((n/a-d.y)/o.view.scale)),c.scale(a/o.view.scale),new mxImageExport().drawState(o.getView().getState(o.model.root),c);var u="xml="+encodeURIComponent(mxUtils.getXml(p)),g=Math.ceil(d.width*a/o.view.scale+2*n),h=Math.ceil(d.height*a/o.view.scale+2*n);u.length<=MAX_REQUEST_SIZE&&g*h<MAX_AREA?(e.hideDialog(),new mxXmlRequest(EXPORT_URL,"format="+l+"&filename="+encodeURIComponent(t)+"&bg="+(null!=i?i:"none")+"&w="+g+"&h="+h+"&"+u+"&dpi="+r).simulate(document,"_blank")):mxUtils.alert(mxResources.get("drawingTooLarge"))}},ExportDialog.saveLocalFile=function(e,t,l,i){t.length<MAX_REQUEST_SIZE?(e.hideDialog(),new mxXmlRequest(SAVE_URL,"xml="+encodeURIComponent(t)+"&filename="+encodeURIComponent(l)+"&format="+i).simulate(document,"_blank")):(mxUtils.alert(mxResources.get("drawingTooLarge")),mxUtils.popup(xml))};var EditDataDialog=function(e,t){var l,i,a,n=document.createElement("div"),r=e.editor.graph,o=r.getModel().getValue(t);if(!mxUtils.isNode(o)){var d=mxUtils.createXmlDocument().createElement("object");d.setAttribute("label",o||""),o=d}var s={};try{var p=mxUtils.getValue(e.editor.graph.getCurrentCellStyle(t),"metaData",null);null!=p&&(s=JSON.parse(p))}catch(c){}var u=new mxForm("properties");u.table.style.width="100%";for(var g=o.attributes,h=[],m=[],$=0,b=null!=EditDataDialog.getDisplayIdForCell?EditDataDialog.getDisplayIdForCell(e,t):null,v=function(e,t){var l=document.createElement("div");l.style.position="relative",l.style.paddingRight="20px",l.style.boxSizing="border-box",l.style.width="100%";var i,a=document.createElement("a"),n=mxUtils.createImage(Dialog.prototype.closeImage);n.style.height="9px",n.style.fontSize="9px",n.style.marginBottom=mxClient.IS_IE11?"-1px":"5px",a.className="geButton",a.setAttribute("title",mxResources.get("delete")),a.style.position="absolute",a.style.top="4px",a.style.right="0px",a.style.margin="0px",a.style.width="9px",a.style.height="9px",a.style.cursor="pointer",a.appendChild(n);var r=(i=t,function(){for(var e=0,t=0;t<h.length;t++){if(h[t]==i){m[t]=null,u.table.deleteRow(e+(null!=b?1:0));break}null!=m[t]&&e++}});mxEvent.addListener(a,"click",r);var o=e.parentNode;l.appendChild(e),l.appendChild(a),o.appendChild(l)},p=[],C=r.getModel().getParent(t)==r.getModel().getRoot(),y=0;y<g.length;y++)(C||"label"!=g[y].nodeName)&&"placeholders"!=g[y].nodeName&&p.push({name:g[y].nodeName,value:g[y].nodeValue});if(p.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),null!=b){var f=document.createElement("div");f.style.width="100%",f.style.fontSize="11px",f.style.textAlign="center",mxUtils.write(f,b),u.addField(mxResources.get("id")+":",f)}for(var y=0;y<p.length;y++)l=$,i=p[y].name,a=p[y].value,h[l]=i,m[l]=u.addTextarea(h[$]+":",a,2),m[l].style.width="100%",a.indexOf("\n")>0&&m[l].setAttribute("rows","2"),v(m[l],i),null!=s[i]&&!1==s[i].editable&&m[l].setAttribute("disabled","disabled"),$++;var w=document.createElement("div");w.style.cssText="position:absolute;left:30px;right:30px;overflow-y:auto;top:30px;bottom:80px;",w.appendChild(u.table);var F=document.createElement("div");F.style.boxSizing="border-box",F.style.paddingRight="160px",F.style.whiteSpace="nowrap",F.style.marginTop="6px",F.style.width="100%";var E=document.createElement("input");E.setAttribute("placeholder",mxResources.get("enterPropertyName")),E.setAttribute("type","text"),E.setAttribute("size",mxClient.IS_IE||mxClient.IS_IE11?"36":"40"),E.style.boxSizing="border-box",E.style.marginLeft="2px",E.style.width="100%",F.appendChild(E),w.appendChild(F),n.appendChild(w);var x=mxUtils.button(mxResources.get("addProperty"),function(){var e=E.value;if(e.length>0&&"label"!=e&&"placeholders"!=e&&0>e.indexOf(":"))try{var t=mxUtils.indexOf(h,e);if(t>=0&&null!=m[t])m[t].focus();else{o.cloneNode(!1).setAttribute(e,""),t>=0&&(h.splice(t,1),m.splice(t,1)),h.push(e);var l=u.addTextarea(e+":","",2);l.style.width="100%",m.push(l),v(l,e),l.focus()}x.setAttribute("disabled","disabled"),E.value=""}catch(i){mxUtils.alert(i)}else mxUtils.alert(mxResources.get("invalidName"))});this.init=function(){m.length>0?m[0].focus():E.focus()},x.setAttribute("title",mxResources.get("addProperty")),x.setAttribute("disabled","disabled"),x.style.textOverflow="ellipsis",x.style.position="absolute",x.style.overflow="hidden",x.style.width="144px",x.style.right="0px",x.className="geBtn",F.appendChild(x);var _=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog.apply(e,arguments)});_.className="geBtn";var A=mxUtils.button(mxResources.get("apply"),function(){try{e.hideDialog.apply(e,arguments),o=o.cloneNode(!0);for(var l=!1,i=0;i<h.length;i++)null==m[i]?o.removeAttribute(h[i]):(o.setAttribute(h[i],m[i].value),l=l||"placeholder"==h[i]&&"1"==o.getAttribute("placeholders"));l&&o.removeAttribute("label"),r.getModel().setValue(t,o)}catch(a){mxUtils.alert(a)}});function k(){E.value.length>0?x.removeAttribute("disabled"):x.setAttribute("disabled","disabled")}A.className="geBtn gePrimaryBtn",mxEvent.addListener(E,"keyup",k),mxEvent.addListener(E,"change",k);var D=document.createElement("div");if(D.style.cssText="position:absolute;left:30px;right:30px;text-align:right;bottom:30px;height:40px;",e.editor.graph.getModel().isVertex(t)||e.editor.graph.getModel().isEdge(t)){var S=document.createElement("span");S.style.marginRight="10px";var L=document.createElement("input");if(L.setAttribute("type","checkbox"),L.style.marginRight="6px","1"==o.getAttribute("placeholders")&&(L.setAttribute("checked","checked"),L.defaultChecked=!0),mxEvent.addListener(L,"click",function(){"1"==o.getAttribute("placeholders")?o.removeAttribute("placeholders"):o.setAttribute("placeholders","1")}),S.appendChild(L),mxUtils.write(S,mxResources.get("placeholders")),null!=EditDataDialog.placeholderHelpLink){var B=document.createElement("a");B.setAttribute("href",EditDataDialog.placeholderHelpLink),B.setAttribute("title",mxResources.get("help")),B.setAttribute("target","_blank"),B.style.marginLeft="8px",B.style.cursor="help";var I=document.createElement("img");mxUtils.setOpacity(I,50),I.style.height="16px",I.style.width="16px",I.setAttribute("border","0"),I.setAttribute("valign","middle"),I.style.marginTop=mxClient.IS_IE11?"0px":"-4px",I.setAttribute("src",Editor.helpImage),B.appendChild(I),S.appendChild(B)}D.appendChild(S)}e.editor.cancelFirst?(D.appendChild(_),D.appendChild(A)):(D.appendChild(A),D.appendChild(_)),n.appendChild(D),this.container=n};EditDataDialog.getDisplayIdForCell=function(e,t){var l=null;return null!=e.editor.graph.getModel().getParent(t)&&(l=t.getId()),l},EditDataDialog.placeholderHelpLink=null;var LinkDialog=function(e,t,l,i){var a=document.createElement("div");mxUtils.write(a,mxResources.get("editLink")+":");var n=document.createElement("div");n.className="geTitle",n.style.backgroundColor="transparent",n.style.borderColor="transparent",n.style.whiteSpace="nowrap",n.style.textOverflow="clip",n.style.cursor="default",mxClient.IS_VML||(n.style.paddingRight="20px");var r=document.createElement("input");r.setAttribute("value",t),r.setAttribute("placeholder","http://www.example.com/"),r.setAttribute("type","text"),r.style.marginTop="6px",r.style.width="400px",r.style.backgroundImage="url('"+Dialog.prototype.clearImage+"')",r.style.backgroundRepeat="no-repeat",r.style.backgroundPosition="100% 50%",r.style.paddingRight="14px";var o=document.createElement("div");o.setAttribute("title",mxResources.get("reset")),o.style.position="relative",o.style.left="-16px",o.style.width="12px",o.style.height="14px",o.style.cursor="pointer",o.style.display=mxClient.IS_VML?"inline":"inline-block",o.style.top=(mxClient.IS_VML?0:3)+"px",o.style.background="url("+IMAGE_PATH+"/transparent.gif)",mxEvent.addListener(o,"click",function(){r.value="",r.focus()}),n.appendChild(r),n.appendChild(o),a.appendChild(n),this.init=function(){r.focus(),mxClient.IS_GC||mxClient.IS_FF||document.documentMode>=5||mxClient.IS_QUIRKS?r.select():document.execCommand("selectAll",!1,null)};var d=document.createElement("div");d.style.marginTop="18px",d.style.textAlign="right",mxEvent.addListener(r,"keypress",function(t){13==t.keyCode&&(e.hideDialog(),i(r.value))});var s=mxUtils.button(mxResources.get("cancel"),function(){e.hideDialog()});s.className="geBtn",e.editor.cancelFirst&&d.appendChild(s);var p=mxUtils.button(l,function(){e.hideDialog(),i(r.value)});p.className="geBtn gePrimaryBtn",d.appendChild(p),e.editor.cancelFirst||d.appendChild(s),a.appendChild(d),this.container=a},OutlineWindow=function(e,t,l,i,a){var n=e.editor.graph,r=document.createElement("div");r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.border="1px solid whiteSmoke",r.style.overflow="hidden",this.window=new mxWindow(mxResources.get("outline"),r,t,l,i,a,!0,!0),this.window.minimumSize=new mxRectangle(0,0,80,80),this.window.destroyOnClose=!1,this.window.setMaximizable(!1),this.window.setResizable(!0),this.window.setClosable(!0),this.window.setVisible(!0),this.window.setLocation=function(e,t){var l=window.innerWidth||document.body.clientWidth||document.documentElement.clientWidth,i=window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight;e=Math.max(0,Math.min(e,l-this.table.clientWidth)),t=Math.max(0,Math.min(t,i-this.table.clientHeight-48)),(this.getX()!=e||this.getY()!=t)&&mxWindow.prototype.setLocation.apply(this,arguments)};var o=mxUtils.bind(this,function(){var e=this.window.getX(),t=this.window.getY();this.window.setLocation(e,t)});mxEvent.addListener(window,"resize",o);var d=e.createOutline(this.window);this.destroy=function(){mxEvent.removeListener(window,"resize",o),this.window.destroy(),d.destroy()},this.window.addListener(mxEvent.RESIZE,mxUtils.bind(this,function(){d.update(!1),d.outline.sizeDidChange()})),this.window.addListener(mxEvent.SHOW,mxUtils.bind(this,function(){this.window.fit(),d.suspended=!1,d.outline.refresh(),d.update()})),this.window.addListener(mxEvent.HIDE,mxUtils.bind(this,function(){d.suspended=!0})),this.window.addListener(mxEvent.NORMALIZE,mxUtils.bind(this,function(){d.suspended=!1,d.update()})),this.window.addListener(mxEvent.MINIMIZE,mxUtils.bind(this,function(){d.suspended=!0}));var s=d.createGraph;function p(){d.outline.pageScale=n.pageScale,d.outline.pageFormat=n.pageFormat,d.outline.pageVisible=n.pageVisible,d.outline.background=null==n.background||n.background==mxConstants.NONE?n.defaultPageBackgroundColor:n.background;var e=mxUtils.getCurrentStyle(n.container);r.style.backgroundColor=e.backgroundColor,null!=n.view.backgroundPageShape&&null!=d.outline.view.backgroundPageShape&&(d.outline.view.backgroundPageShape.fill=n.view.backgroundPageShape.fill),d.outline.refresh()}if(d.createGraph=function(e){var t=s.apply(this,arguments);t.gridEnabled=!1,t.pageScale=n.pageScale,t.pageFormat=n.pageFormat,t.background=null==n.background||n.background==mxConstants.NONE?n.defaultPageBackgroundColor:n.background,t.pageVisible=n.pageVisible;var l=mxUtils.getCurrentStyle(n.container);return r.style.backgroundColor=l.backgroundColor,t},d.init(r),e.editor.addListener("resetGraphView",p),e.addListener("pageFormatChanged",p),e.addListener("backgroundColorChanged",p),e.addListener("backgroundImageChanged",p),e.addListener("pageViewChanged",function(){p(),d.update(!0)}),d.outline.dialect==mxConstants.DIALECT_SVG){var c=e.actions.get("zoomIn"),u=e.actions.get("zoomOut");mxEvent.addMouseWheelListener(function(e,t){for(var l=!1,i=mxEvent.getSource(e);null!=i;){if(i==d.outline.view.canvas.ownerSVGElement){l=!0;break}i=i.parentNode}l&&(t?c.funct():u.funct())})}},LayersWindow=function(e,t,l,i,a){var n=e.editor.graph,r=document.createElement("div");r.style.userSelect="none",r.style.background="white"==Dialog.backdropColor?"whiteSmoke":Dialog.backdropColor,r.style.border="1px solid whiteSmoke",r.style.height="100%",r.style.marginBottom="10px",r.style.overflow="auto";var o=EditorUi.compactUi?"26px":"30px",d=document.createElement("div");d.style.backgroundColor="white"==Dialog.backdropColor?"#dcdcdc":Dialog.backdropColor,d.style.position="absolute",d.style.overflow="auto",d.style.left="0px",d.style.right="0px",d.style.top="0px",d.style.bottom=parseInt(o)+7+"px",r.appendChild(d);var s=null,p=null;mxEvent.addListener(r,"dragover",function(e){e.dataTransfer.dropEffect="move",p=0,e.stopPropagation(),e.preventDefault()}),mxEvent.addListener(r,"drop",function(e){e.stopPropagation(),e.preventDefault()});var c=null,u=null,g=document.createElement("div");g.className="geToolbarContainer",g.style.position="absolute",g.style.bottom="0px",g.style.left="0px",g.style.right="0px",g.style.height=o,g.style.overflow="hidden",g.style.padding=EditorUi.compactUi?"4px 0px 3px 0px":"1px",g.style.backgroundColor="white"==Dialog.backdropColor?"whiteSmoke":Dialog.backdropColor,g.style.borderWidth="1px 0px 0px 0px",g.style.borderColor="#c3c3c3",g.style.borderStyle="solid",g.style.display="block",g.style.whiteSpace="nowrap",mxClient.IS_QUIRKS&&(g.style.filter="none");var h=document.createElement("a");h.className="geButton",mxClient.IS_QUIRKS&&(h.style.filter="none");var m=h.cloneNode();m.innerHTML='<div class="geSprite geSprite-delete" style="display:inline-block;"></div>',mxEvent.addListener(m,"click",function(e){if(n.isEnabled()){n.model.beginUpdate();try{var t=n.model.root.getIndex(u);n.removeCells([u],!1),0==n.model.getChildCount(n.model.root)?(n.model.add(n.model.root,new mxCell),n.setDefaultParent(null)):t>0&&t<=n.model.getChildCount(n.model.root)?n.setDefaultParent(n.model.getChildAt(n.model.root,t-1)):n.setDefaultParent(null)}finally{n.model.endUpdate()}}mxEvent.consume(e)}),n.isEnabled()||(m.className="geButton mxDisabled"),g.appendChild(m);var $=h.cloneNode();$.setAttribute("title",mxUtils.trim(mxResources.get("moveSelectionTo",["..."]))),$.innerHTML='<div class="geSprite geSprite-insert" style="display:inline-block;"></div>',mxEvent.addListener($,"click",function(t){if(n.isEnabled()&&!n.isSelectionEmpty()){var l=mxUtils.getOffset($);e.showPopupMenu(mxUtils.bind(this,function(e,t){for(var l=c-1;l>=0;l--)mxUtils.bind(this,function(l){var i=e.addItem(n.convertValueToString(l)||mxResources.get("background"),null,mxUtils.bind(this,function(){n.moveCells(n.getSelectionCells(),0,0,!1,l)}),t);1==n.getSelectionCount()&&n.model.isAncestor(l,n.getSelectionCell())&&e.addCheckmark(i,Editor.checkmarkImage)})(n.model.getChildAt(n.model.root,l))}),l.x,l.y+$.offsetHeight,t)}}),g.appendChild($);var b=h.cloneNode();b.innerHTML='<div class="geSprite geSprite-dots" style="display:inline-block;"></div>',b.setAttribute("title",mxResources.get("rename")),mxEvent.addListener(b,"click",function(t){n.isEnabled()&&e.showDataDialog(u),mxEvent.consume(t)}),n.isEnabled()||(b.className="geButton mxDisabled"),g.appendChild(b);var v=h.cloneNode();v.innerHTML='<div class="geSprite geSprite-duplicate" style="display:inline-block;"></div>',mxEvent.addListener(v,"click",function(e){if(n.isEnabled()){var t=null;n.model.beginUpdate();try{t=n.cloneCell(u),n.cellLabelChanged(t,mxResources.get("untitledLayer")),t.setVisible(!0),t=n.addCell(t,n.model.root),n.setDefaultParent(t)}finally{n.model.endUpdate()}null==t||n.isCellLocked(t)||n.selectAll(t)}}),n.isEnabled()||(v.className="geButton mxDisabled"),g.appendChild(v);var C=h.cloneNode();function y(){function t(t,l,i,a){var r=document.createElement("div");r.className="geToolbarContainer",r.style.overflow="hidden",r.style.position="relative",r.style.padding="4px",r.style.height="22px",r.style.display="block",r.style.backgroundColor="white"==Dialog.backdropColor?"whiteSmoke":Dialog.backdropColor,r.style.borderWidth="0px 0px 1px 0px",r.style.borderColor="#c3c3c3",r.style.borderStyle="solid",r.style.whiteSpace="nowrap",r.setAttribute("title",l);var o=document.createElement("div");o.style.display="inline-block",o.style.width="100%",o.style.textOverflow="ellipsis",o.style.overflow="hidden",mxEvent.addListener(r,"dragover",function(e){e.dataTransfer.dropEffect="move",p=t,e.stopPropagation(),e.preventDefault()}),mxEvent.addListener(r,"dragstart",function(e){s=r,mxClient.IS_FF&&e.dataTransfer.setData("Text","<layer/>")}),mxEvent.addListener(r,"dragend",function(e){null!=s&&null!=p&&n.addCell(i,n.model.root,p),s=null,p=null,e.stopPropagation(),e.preventDefault()});var g=document.createElement("img");g.setAttribute("draggable","false"),g.setAttribute("align","top"),g.setAttribute("border","0"),g.style.padding="4px",g.setAttribute("title",mxResources.get("lockUnlock"));var h=n.getCurrentCellStyle(i);"1"==mxUtils.getValue(h,"locked","0")?g.setAttribute("src",Dialog.prototype.lockedImage):g.setAttribute("src",Dialog.prototype.unlockedImage),n.isEnabled()&&(g.style.cursor="pointer"),mxEvent.addListener(g,"click",function(e){if(n.isEnabled()){var t=null;n.getModel().beginUpdate();try{t="1"==mxUtils.getValue(h,"locked","0")?null:"1",n.setCellStyles("locked",t,[i])}finally{n.getModel().endUpdate()}"1"==t&&n.removeSelectionCells(n.getModel().getDescendants(i)),mxEvent.consume(e)}}),o.appendChild(g);var m=document.createElement("input");if(m.setAttribute("type","checkbox"),m.setAttribute("title",mxResources.get("hideIt",[i.value||mxResources.get("background")])),m.style.marginLeft="4px",m.style.marginRight="6px",m.style.marginTop="4px",o.appendChild(m),n.model.isVisible(i)&&(m.setAttribute("checked","checked"),m.defaultChecked=!0),mxEvent.addListener(m,"click",function(e){n.model.setVisible(i,!n.model.isVisible(i)),mxEvent.consume(e)}),mxUtils.write(o,l),r.appendChild(o),n.isEnabled()){if(mxClient.IS_TOUCH||mxClient.IS_POINTER||mxClient.IS_VML||mxClient.IS_IE&&document.documentMode<10){var $=document.createElement("div");if($.style.display="block",$.style.textAlign="right",$.style.whiteSpace="nowrap",$.style.position="absolute",$.style.right="6px",$.style.top="6px",t>0){var b=document.createElement("a");b.setAttribute("title",mxResources.get("toBack")),b.className="geButton",b.style.cssFloat="none",b.innerHTML="&#9660;",b.style.width="14px",b.style.height="14px",b.style.fontSize="14px",b.style.margin="0px",b.style.marginTop="-1px",$.appendChild(b),mxEvent.addListener(b,"click",function(e){n.isEnabled()&&n.addCell(i,n.model.root,t-1),mxEvent.consume(e)})}if(t>=0&&t<c-1){var v=document.createElement("a");v.setAttribute("title",mxResources.get("toFront")),v.className="geButton",v.style.cssFloat="none",v.innerHTML="&#9650;",v.style.width="14px",v.style.height="14px",v.style.fontSize="14px",v.style.margin="0px",v.style.marginTop="-1px",$.appendChild(v),mxEvent.addListener(v,"click",function(e){n.isEnabled()&&n.addCell(i,n.model.root,t+1),mxEvent.consume(e)})}r.appendChild($)}mxClient.IS_SVG&&(!mxClient.IS_IE||document.documentMode>=10)&&(r.setAttribute("draggable","true"),r.style.cursor="move")}mxEvent.addListener(r,"dblclick",function(t){var l=mxEvent.getSource(t).nodeName;"INPUT"!=l&&"IMG"!=l&&(function t(l){if(n.isEnabled()&&null!=l){var i=n.convertValueToString(l),a=new FilenameDialog(e,i||mxResources.get("background"),mxResources.get("rename"),mxUtils.bind(this,function(e){null!=e&&n.cellLabelChanged(l,e)}),mxResources.get("enterName"));e.showDialog(a.container,300,100,!0,!0),a.init()}}(i),mxEvent.consume(t))}),n.getDefaultParent()==i?(r.style.background="white"==Dialog.backdropColor?"#e6eff8":"#505759",r.style.fontWeight=n.isEnabled()?"bold":"",u=i):mxEvent.addListener(r,"click",function(e){n.isEnabled()&&(n.setDefaultParent(a),n.view.setCurrentRoot(null))}),d.appendChild(r)}c=n.model.getChildCount(n.model.root),d.innerHTML="";for(var l=c-1;l>=0;l--)mxUtils.bind(this,function(e){t(l,n.convertValueToString(e)||mxResources.get("background"),e,e)})(n.model.getChildAt(n.model.root,l));var i=n.convertValueToString(u)||mxResources.get("background");m.setAttribute("title",mxResources.get("removeIt",[i])),v.setAttribute("title",mxResources.get("duplicateIt",[i])),b.setAttribute("title",mxResources.get("editData")),n.isSelectionEmpty()&&($.className="geButton mxDisabled")}C.innerHTML='<div class="geSprite geSprite-plus" style="display:inline-block;"></div>',C.setAttribute("title",mxResources.get("addLayer")),mxEvent.addListener(C,"click",function(e){if(n.isEnabled()){n.model.beginUpdate();try{var t=n.addCell(new mxCell(mxResources.get("untitledLayer")),n.model.root);n.setDefaultParent(t)}finally{n.model.endUpdate()}}mxEvent.consume(e)}),n.isEnabled()||(C.className="geButton mxDisabled"),g.appendChild(C),r.appendChild(g),y(),n.model.addListener(mxEvent.CHANGE,y),n.addListener("defaultParentChanged",y),n.selectionModel.addListener(mxEvent.CHANGE,function(){n.isSelectionEmpty()?$.className="geButton mxDisabled":$.className="geButton"}),this.window=new mxWindow(mxResources.get("layers"),r,t,l,i,a,!0,!0),this.window.minimumSize=new mxRectangle(0,0,120,120),this.window.destroyOnClose=!1,this.window.setMaximizable(!1),this.window.setResizable(!0),this.window.setClosable(!0),this.window.setVisible(!0),this.init=function(){d.scrollTop=d.scrollHeight-d.clientHeight},this.window.addListener(mxEvent.SHOW,mxUtils.bind(this,function(){this.window.fit()})),this.refreshLayers=y,this.window.setLocation=function(e,t){var l=window.innerWidth||document.body.clientWidth||document.documentElement.clientWidth,i=window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight;e=Math.max(0,Math.min(e,l-this.table.clientWidth)),t=Math.max(0,Math.min(t,i-this.table.clientHeight-48)),(this.getX()!=e||this.getY()!=t)&&mxWindow.prototype.setLocation.apply(this,arguments)};var f=mxUtils.bind(this,function(){var e=this.window.getX(),t=this.window.getY();this.window.setLocation(e,t)});mxEvent.addListener(window,"resize",f),this.destroy=function(){mxEvent.removeListener(window,"resize",f),this.window.destroy()}};